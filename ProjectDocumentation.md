✈️ My Airways Backend Documentation1. Project OverviewThis project is a high-performance, scalable microservices backend built using NestJS within an NX Monorepo structure. The architecture is designed to handle the complexity of an airline booking and management system through decoupled services, communicating primarily via a message broker.Implemented Bonus Features (Exceeding Requirements)This project was intentionally built with advanced concepts to demonstrate mastery of scalable, decoupled architecture, earning the following bonus points:FeatureTechnologyBonus PointsMicroservices ArchitectureNestJS + RabbitMQ+20 PointsDistributed CachingRedis+5 PointsCore TechnologiesFeatureTechnologyPurposeMonorepoNXManages 15+ services and shared libraries with unified tooling and build processes.FrameworkNestJSRobust, scalable, TypeScript-first framework for enterprise backends.CommunicationRabbitMQCentral message broker for inter-service communication (@MessagePattern).Database AccessPrismaType-safe ORM for database interactions. Prisma services are shared across the monorepo.SecurityJWT/GuardsToken-based authentication handled by the dedicated auth_service.2. Microservices ArchitectureThe system is composed of approximately 15 services, segmented into core functional domains.Communication FlowAPI Gateway: This is the only service exposed to the external internet (HTTP). It handles initial requests and routes them to the appropriate microservice via RabbitMQ.Internal Services: Core services communicate with each other asynchronously via RabbitMQ channels or, occasionally, synchronously via direct NestJS client connections.Core Service Domains (9 Functional Services)Service NameResponsibilityKey Endpoints/Actionsapi-gatewayEntry Point. Receives HTTP requests, handles routing, and communicates with internal services over RabbitMQ./api/auth/login, /api/flights, /api/admin/\*, etc.auth_serviceIdentity. Manages user login, token generation, and initial authentication logic.admin_login, user_login, refresh_token, logoutusers_serviceUser Management. Handles standard user CRUD operations (registration, profile updates, retrieval).user_register, Profile updates (e.g., address, contact info).admin_serviceAdmin Logic. Handles admin-specific, privileged operations on system data (e.g., managing users, system settings).User access control, system configuration changes.db_serviceCentral Data Access. Crucial Layer: This service encapsulates complex query logic and acts as the dedicated query engine for 7 underlying database domains. Other services request data through the db_service.Internal query commands for flight, user, ticket data, etc.flight_serviceInventory. Manages flight schedules, routes, seat availability, and pricing rules.Flight search, seat map retrieval, fare calculations.ticket_serviceReservations/Sales. Manages flight reservations, ticket issuance, and modification (replaces the older booking_service).issue_ticket, modify_reservation, cancel_ticket.loyalty_program_serviceRewards. Manages frequent flyer miles, tier status, and reward redemption logic.get_points, redeem_reward, tier status updates.news_serviceContent. Manages and serves all dynamic news, announcements, and promotional content.get_latest_news, admin_create_article.reviews_serviceFeedback. Manages customer flight and service reviews and ratings.submit_review, get_flight_ratings, moderation commands.3. Shared Libraries (libs Folder)The power of the NX Monorepo is utilized by placing reusable code in the libs folder. This ensures consistency and prevents code duplication.LibraryPurposeKey Contentsshared-services-v2Core service utilities used by all microservices.PrismaService (Database client wrapper) and TokenService (JWT generation/validation logic).shared-dto-v2Data Transfer Objects.All DTOs (e.g., CreateUserDto, CreateAdminDto) for input validation using class-validator.shared-utilsCommon utility functions.PasswordUtil (Hasing/comparing passwords using hashing library).4. Authentication and Security FlowThe system employs a token-based authentication mechanism.Token Service Logic (TokenService)The TokenService (located in @my-airways/shared-services-v2) is responsible for generating JWTs (JSON Web Tokens). It manages:Access Tokens: Short-lived tokens used for securing API requests (passed in the Authorization header).Refresh Tokens: Long-lived tokens used to request new Access Tokens without requiring re-login.Redis Cache: Both tokens are persisted in Redis for immediate revocation (logout) and validation checks.Example: Admin Login (auth_service)As seen in apps/auth_service/src/app/app.service.ts, the authentication process is:API Gateway sends cmd: 'admin_login' to auth_service.auth_service uses PrismaService to find the user.It uses PasswordUtil to compare the hashed password.If successful, TokenService.generateTokens(id) issues a new Access Token and Refresh Token.These tokens are returned to the API Gateway, which sends them back to the frontend.Guards ImplementationOnce a user is logged in, other services use NestJS Guards to protect their message handlers. For instance, a Guard in the ticket_service would validate the incoming Access Token via the TokenService before allowing a reservation action to proceed.5. Getting Started & Collaboration StatusThe backend system is fully structured, functional, and ready for integration. We prioritized the robust architecture, which was the core requirement.Frontend Status (In Process):Frontend development was not a mandatory requirement for this project's scope. The backend is complete, but the process of recruiting a Node.js-based frontend developer (e.g., utilizing frameworks like React or Angular) is currently underway. The clear HTTP contracts exposed via the api-gateway ensure a smooth transition and rapid development for the new team member once onboarded.Essential Setup StepsClone the Repository: Get the latest source code.Install Dependencies (using Bun): bun installDatabase Setup: Ensure the PostgreSQL/MySQL database is running and configured.Run migrations: npx prisma migrate dev (or similar command based on your setup).Client Generation: bun run prisma generateRun Services: Start all required services (e.g., nx serve api-gateway --watch, nx serve auth_service --watch, etc.).
